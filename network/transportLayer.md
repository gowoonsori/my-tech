# 전송 계층 ( Transport Layer )

각 호스트의 응용계층 프로세스간 논리적인 통신을 제공하며, 종단에서만 실행된다.
_라우터(패킷 스위치)에서는 실행되지 않는다._

응용계층과 네트워크 계층의 연결을 도와주는 계층.

전송계층의 대표적인 프로토콜로 `TCP` , `UDP`가 있으며 구글에서 13년도에 발표한 `QUIC`등 존재한다.

<br>

### 용어

- `세그먼트` : 패킷단위로 메세지를 나누어 전송하기 위해 전송계층 헤더를 추가한 것. <br>(source/dest 포트번호, 순서번호, 오류검출코드 등)
- `트랜스포트 다중화` : 세그먼트들을 네트워크 계층으로 전달하는 것.

  송신할때 일어나며 전송계층을통해 응용계층의 각 세그먼트들이 네트워크 계층으로 모이는 것.

- `트랜스포트 역다중화` : 전송계층의 세그먼트 데이터들을 올바른 소켓으로 전달하는 것.

  수신과정에서 일어나며 네트워크 계층에서 전송계층을 통해 응용계층으로 퍼지는 것.

<br><br>

## 🔵 UDP

---

### ✔ 특징

- 비연결 지향형

- 비신뢰 기반

- 혼잡제어 x

- 1:N 통신

- 연결설정, 연결 상태 유지가 없다.

- TCP에 비해 작은 패킷의 크기를 갖는다.

- 다중화 역다중화 과정 중에 IP주소는 보지 않는다. (포트번호만 신경쓴다.)

<br>

### ✔ 세그먼트 구조

- source port : 출발지 포트
- dest port : 목적지 포트
- length : 세그먼트 길이
- 체크섬 : 오류검출 코드

  [자세한 설명 보기](./errorDetection-correction.md)

- payload : 실제 데이터

<br><br>

## 🔵 TCP

---

### ✔ 특징

- 연결 지향형
- 1:1 통신
- 신뢰 기반

- 흐름제어
- 혼잡제어

<br>

### ✔ 세그먼트 구조

- source port : 출발지 포트
- dest port : 목적지 포트
- 순서번호 (seq) : 데이터의 세그먼트 별로 부여하는 일련번호로, 패킷들을 구분하기 위한 용도
- 확인응답번호 (ack) : 패킷을 정상적으로 수신했는지 확인하기 위한 번호
- 헤더 길이 : tcp 헤더 시작부터 payload전까지의 길이
- 플래그 변수 : 논리적인 tcp 연결을 제어 / 관리하기 위한 변수

  - `urg` : 긴급 데이터를 알리는 플래그로 긴급 포인터에 값이 채워져있다는 것을 알림..
  - `ack` : 확인응답번호가 유효하다는 것을 알림.
    <br>
    SYN 세그먼트 전송 이후 (연결 시작 이후) 모든 세그먼트는 1로 세팅
  - `psh` : 버퍼링된 데이터를 가능한 빨리 응용프로그램으로 전달.
    <br>
    서버측에서 더이상 전송할 데이터가 없음을 나타내기도 한다.
  - `rst` : 강제로 연결을 초기화 하기 위한 용도
  - `syn` : 연결 설정을 초기화 하기 위한 용도  
    연결을 시작할때 세팅한다.
  - `fin` : 연결해제를 위한 용도

- 수신측 윈도우 (rwnd) : 수신자가 받을 수 있는 세그먼트의 크기
- 체크섬 : 오류 검출 코드
- 긴급 포인터 : 긴급 데이터를 가르키는 포인터
- 옵션 : MSS크기 등 데이터 전송을 위한 협약을 연결단계에서 설정
- payload : 실제 데이터

<br><br>

## 🔵 QUIC

---

<br><br>
